/**
 * skylark-zxcvbn - A version of zxcvbn.js that ported to running on skylarkjs.
 * @author Hudaokeji, Inc.
 * @version v0.9.0
 * @link https://github.com/skylark-integration/skylark-zxcvbn/
 * @license MIT
 */
define(["./adjacency_graphs","./frequency_lists","./scoring"],function(t,e,n){var r,i,a,s,o,h,u,c;for(c in h=function(t){var e,n,r,i;for(i={},e=1,r=0,n=t.length;r<n;r++)i[t[r]]=e,e+=1;return i},s={},e)u=e[c],s[c]=h(u);return i={qwerty:t.qwerty,dvorak:t.dvorak,keypad:t.keypad,mac_keypad:t.mac_keypad},a={a:["4","@"],b:["8"],c:["(","{","[","<"],e:["3"],g:["6","9"],i:["1","!","|"],l:["1","|","7"],o:["0"],s:["$","5"],t:["+","7"],x:["%"],z:["2"]},o={recent_year:/19\d\d|200\d|201\d/g},2050,1e3,r={4:[[1,2],[2,3]],5:[[1,3],[2,3]],6:[[1,2],[2,4],[4,5]],7:[[1,3],[2,3],[4,5],[4,6]],8:[[2,4],[4,6]]},{empty:function(t){var e;return 0===function(){var n;for(e in n=[],t)n.push(e);return n}().length},extend:function(t,e){return t.push.apply(t,e)},translate:function(t,e){var n;return function(){var r,i,a,s;for(s=[],i=0,r=(a=t.split("")).length;i<r;i++)n=a[i],s.push(e[n]||n);return s}().join("")},mod:function(t,e){return(t%e+e)%e},sorted:function(t){return t.sort(function(t,e){return t.i-e.i||t.j-e.j})},omnimatch:function(t){var e,n,r,i,a;for(i=[],a=0,e=(r=[this.dictionary_match,this.reverse_dictionary_match,this.l33t_match,this.spatial_match,this.repeat_match,this.sequence_match,this.regex_match,this.date_match]).length;a<e;a++)n=r[a],this.extend(i,n.call(this,t));return this.sorted(i)},dictionary_match:function(t,e=s){var n,r,i,a,o,h,u,c,l,f,_,d,p,g;for(n in o=[],a=t.length,c=t.toLowerCase(),e)for(f=e[n],r=h=0,_=a;0<=_?h<_:h>_;r=0<=_?++h:--h)for(i=u=d=r,p=a;d<=p?u<p:u>p;i=d<=p?++u:--u)c.slice(r,+i+1||9e9)in f&&(l=f[g=c.slice(r,+i+1||9e9)],o.push({pattern:"dictionary",i:r,j:i,token:t.slice(r,+i+1||9e9),matched_word:g,rank:l,dictionary_name:n,reversed:!1,l33t:!1}));return this.sorted(o)},reverse_dictionary_match:function(t,e=s){var n,r,i,a,o;for(o=t.split("").reverse().join(""),a=0,n=(i=this.dictionary_match(o,e)).length;a<n;a++)(r=i[a]).token=r.token.split("").reverse().join(""),r.reversed=!0,[r.i,r.j]=[t.length-1-r.j,t.length-1-r.i];return this.sorted(i)},set_user_input_dictionary:function(t){return s.user_inputs=h(t.slice())},relevant_l33t_subtable:function(t,e){var n,r,i,a,s,o,h,u,c,l;for(s={},a=0,r=(o=t.split("")).length;a<r;a++)n=o[a],s[n]=!0;for(i in l={},e)c=e[i],(h=function(){var t,e,n;for(n=[],e=0,t=c.length;e<t;e++)(u=c[e])in s&&n.push(u);return n}()).length>0&&(l[i]=h);return l},enumerate_l33t_subs:function(t){var e,n,r,i,a,s,o,h,u,c,l,f,_,d;for(a=function(){var e;for(i in e=[],t)e.push(i);return e}(),d=[[]],n=function(t){var e,n,r,a,s,o,h,u;for(n=[],s={},o=0,a=t.length;o<a;o++)h=t[o],(e=function(){var t,e,n;for(n=[],u=e=0,t=h.length;e<t;u=++e)i=h[u],n.push([i,u]);return n}()).sort(),(r=function(){var t,n,r;for(r=[],u=n=0,t=e.length;n<t;u=++n)i=e[u],r.push(i+","+u);return r}().join("-"))in s||(s[r]=!0,n.push(h));return n},(r=function(e){var i,a,s,o,h,u,c,l,f,_,p,g,m,y,v,x;if(e.length){for(a=e[0],m=e.slice(1),c=[],l=0,h=(p=t[a]).length;l<h;l++)for(o=p[l],f=0,u=d.length;f<u;f++){for(i=-1,s=_=0,g=(y=d[f]).length;0<=g?_<g:_>g;s=0<=g?++_:--_)if(y[s][0]===o){i=s;break}-1===i?(x=y.concat([[o,a]]),c.push(x)):((v=y.slice(0)).splice(i,1),v.push([o,a]),c.push(y),c.push(v))}return d=n(c),r(m)}})(a),_=[],u=0,o=d.length;u<o;u++){for(f={},c=0,h=(l=d[u]).length;c<h;c++)[s,e]=l[c],f[s]=e;_.push(f)}return _},l33t_match:function(t,e=s,n=a){var r,i,o,h,u,c,l,f,_,d,p,g,m,y,v,x;for(l=[],f=0,o=(d=this.enumerate_l33t_subs(this.relevant_l33t_subtable(t,n))).length;f<o&&(g=d[f],!this.empty(g));f++)for(y=this.translate(t,g),_=0,h=(p=this.dictionary_match(y,e)).length;_<h;_++)if(u=p[_],(v=t.slice(u.i,+u.j+1||9e9)).toLowerCase()!==u.matched_word){for(m in c={},g)r=g[m],-1!==v.indexOf(m)&&(c[m]=r);u.l33t=!0,u.token=v,u.sub=c,u.sub_display=function(){var t;for(i in t=[],c)x=c[i],t.push(`${i} -> ${x}`);return t}().join(", "),l.push(u)}return this.sorted(l.filter(function(t){return t.token.length>1}))},spatial_match:function(t,e=i){var n,r,a;for(r in a=[],e)n=e[r],this.extend(a,this.spatial_match_helper(t,n,r));return this.sorted(a)},SHIFTED_RX:/[~!@#$%^&*()_+QWERTYUIOP{}|ASDFGHJKL:"ZXCVBNM<>?]/,spatial_match_helper:function(t,e,n){var r,i,a,s,o,h,u,c,l,f,_,d,p,g;for(_=[],u=0;u<t.length-1;)for(c=u+1,l=null,g=0,p="qwerty"!==n&&"dvorak"!==n||!this.SHIFTED_RX.exec(t.charAt(u))?0:1;;){if(o=!1,h=-1,s=-1,i=e[t.charAt(c-1)]||[],c<t.length)for(a=t.charAt(c),d=0,f=i.length;d<f;d++)if(s+=1,(r=i[d])&&-1!==r.indexOf(a)){o=!0,h=s,1===r.indexOf(a)&&(p+=1),l!==h&&(g+=1,l=h);break}if(!o){c-u>2&&_.push({pattern:"spatial",i:u,j:c-1,token:t.slice(u,c),graph:n,turns:g,shifted_count:p}),u=c;break}c+=1}return _},repeat_match:function(t){var e,r,i,a,s,o,h,u,c,l,f,_,d,p;for(p=[],s=/(.+)\1+/g,l=/(.+?)\1+/g,f=/^(.+?)\1+$/,c=0;c<t.length&&(s.lastIndex=l.lastIndex=c,o=s.exec(t),_=l.exec(t),null!=o);)o[0].length>_[0].length?(d=o,a=f.exec(d[0])[1]):a=(d=_)[1],[h,u]=[d.index,d.index+d[0].length-1],i=(e=n.most_guessable_match_sequence(a,this.omnimatch(a))).sequence,r=e.guesses,p.push({pattern:"repeat",i:h,j:u,token:d[0],base_token:a,base_guesses:r,base_matches:i,repeat_count:d[0].length/a.length}),c=u+1;return p},MAX_DELTA:5,sequence_match:function(t){var e,n,r,i,a,s,o,h,u;if(1===t.length)return[];for(u=((e,n,r)=>{var i,a,s,o;if((n-e>1||1===Math.abs(r))&&0<(i=Math.abs(r))&&i<=this.MAX_DELTA)return o=t.slice(e,+n+1||9e9),/^[a-z]+$/.test(o)?(a="lower",s=26):/^[A-Z]+$/.test(o)?(a="upper",s=26):/^\d+$/.test(o)?(a="digits",s=10):(a="unicode",s=26),h.push({pattern:"sequence",i:e,j:n,token:t.slice(e,+n+1||9e9),sequence_name:a,sequence_space:s,ascending:r>0})}),h=[],n=0,a=null,i=s=1,o=t.length;1<=o?s<o:s>o;i=1<=o?++s:--s)e=t.charCodeAt(i)-t.charCodeAt(i-1),null==a&&(a=e),e!==a&&(u(n,r=i-1,a),n=r,a=e);return u(n,t.length-1,a),h},regex_match:function(t,e=o){var n,r,i,a;for(c in n=[],e)for((r=e[c]).lastIndex=0;i=r.exec(t);)a=i[0],n.push({pattern:"regex",token:a,i:i.index,j:i.index+i[0].length-1,regex_name:c,regex_match:i});return this.sorted(n)},date_match:function(t){var e,i,a,s,o,h,u,c,l,f,_,d,p,g,m,y,v,x,k,b,j,A,I,q,w,E,$,C,M,R,D,L;for(d=[],p=/^\d{4,8}$/,g=/^(\d{1,4})([\s\/\\_.-])(\d{1,2})\2(\d{1,4})$/,h=v=0,j=t.length-4;0<=j?v<=j:v>=j;h=0<=j?++v:--v)for(u=x=A=h+3,I=h+7;(A<=I?x<=I:x>=I)&&!(u>=t.length);u=A<=I?++x:--x)if(L=t.slice(h,+u+1||9e9),p.exec(L)){for(a=[],k=0,f=(q=r[L.length]).length;k<f;k++)[c,l]=q[k],null!=(o=this.map_ints_to_dmy([parseInt(L.slice(0,c)),parseInt(L.slice(c,l)),parseInt(L.slice(l))]))&&a.push(o);if(a.length>0){for(e=a[0],y=(m=function(t){return Math.abs(t.year-n.REFERENCE_YEAR)})(a[0]),b=0,_=(w=a.slice(1)).length;b<_;b++)(s=m(i=w[b]))<y&&([e,y]=[i,s]);d.push({pattern:"date",token:L,i:h,j:u,separator:"",year:e.year,month:e.month,day:e.day})}}for(h=R=0,E=t.length-6;0<=E?R<=E:R>=E;h=0<=E?++R:--R)for(u=D=$=h+5,C=h+9;($<=C?D<=C:D>=C)&&!(u>=t.length);u=$<=C?++D:--D)L=t.slice(h,+u+1||9e9),null!=(M=g.exec(L))&&null!=(o=this.map_ints_to_dmy([parseInt(M[1]),parseInt(M[3]),parseInt(M[4])]))&&d.push({pattern:"date",token:L,i:h,j:u,separator:M[2],year:o.year,month:o.month,day:o.day});return this.sorted(d.filter(function(t){var e,n,r,i;for(e=!1,i=0,n=d.length;i<n;i++)if(t!==(r=d[i])&&r.i<=t.i&&r.j>=t.j){e=!0;break}return!e}))},map_ints_to_dmy:function(t){var e,n,r,i,a,s,o,h,u,c,l,f,_,d;if(!(t[1]>31||t[1]<=0)){for(o=0,h=0,_=0,s=0,r=t.length;s<r;s++){if(99<(n=t[s])&&n<1e3||n>2050)return;n>31&&(h+=1),n>12&&(o+=1),n<=0&&(_+=1)}if(!(h>=2||3===o||_>=2)){for(u=0,i=(c=[[t[2],t.slice(0,2)],[t[0],t.slice(1,3)]]).length;u<i;u++)if([d,f]=c[u],1e3<=d&&d<=2050)return null!=(e=this.map_ints_to_dm(f))?{year:d,month:e.month,day:e.day}:void 0;for(l=0,a=c.length;l<a;l++)if([d,f]=c[l],null!=(e=this.map_ints_to_dm(f)))return{year:d=this.two_to_four_digit_year(d),month:e.month,day:e.day}}}},map_ints_to_dm:function(t){var e,n,r,i,a;for(i=0,n=(a=[t,t.slice().reverse()]).length;i<n;i++)if([e,r]=a[i],1<=e&&e<=31&&1<=r&&r<=12)return{day:e,month:r}},two_to_four_digit_year:function(t){return t>99?t:t>50?t+1900:t+2e3}}});
//# sourceMappingURL=sourcemaps/matching.js.map
