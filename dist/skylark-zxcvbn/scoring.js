/**
 * skylark-zxcvbn - A version of zxcvbn.js that ported to running on skylarkjs.
 * @author Hudaokeji, Inc.
 * @version v0.9.0
 * @link https://github.com/skylark-integration/skylark-zxcvbn/
 * @license MIT
 */
define(["./adjacency_graphs"],function(e){var t,r;return t=function(e){var t,r,n,s,a;for(n in t=0,e)a=e[n],t+=function(){var e,t,r;for(r=[],t=0,e=a.length;t<e;t++)(s=a[t])&&r.push(s);return r}().length;return t/=function(){var t;for(r in t=[],e)e[r],t.push(r);return t}().length},10,1e4,10,50,{nCk:function(e,t){var r,n,s,a;if(t>e)return 0;if(0===t)return 1;for(s=1,r=n=1,a=t;1<=a?n<=a:n>=a;r=1<=a?++n:--n)s*=e,s/=r,e-=1;return s},log10:function(e){return Math.log(e)/Math.log(10)},log2:function(e){return Math.log(e)/Math.log(2)},factorial:function(e){var t,r,n,s;if(e<2)return 1;for(t=1,r=n=2,s=e;2<=s?n<=s:n>=s;r=2<=s?++n:--n)t*=r;return t},most_guessable_match_sequence:function(e,t,r=!1){var n,s,a,i,u,o,h,f,g,_,c,l,E,p,A,v,R,m,I,P,M,k;for(c=e.length,_=function(){var e,t,r;for(r=[],e=0,t=c;0<=t?e<t:e>t;0<=t?++e:--e)r.push([]);return r}(),l=0,u=t.length;l<u;l++)_[(f=t[l]).j].push(f);for(v=0,o=_.length;v<o;v++)_[v].sort(function(e,t){return e.i-t.i});for(E={m:function(){var e,t,r;for(t=[],r=0,e=c;0<=e?r<e:r>e;0<=e?++r:--r)t.push({});return t}(),pi:function(){var e,t,r;for(t=[],r=0,e=c;0<=e?r<e:r>e;0<=e?++r:--r)t.push({});return t}(),g:function(){var e,t,r;for(t=[],r=0,e=c;0<=e?r<e:r>e;0<=e?++r:--r)t.push({});return t}()},M=((t,n)=>{var s,a,i,u,o,h;for(a in u=t.j,o=this.estimate_guesses(t,e),n>1&&(o*=E.pi[t.i-1][n-1]),i=this.factorial(n)*o,r||(i+=Math.pow(1e4,n-1)),h=E.g[u])if(s=h[a],!(a>n)&&s<=i)return;return E.g[u][n]=i,E.m[u][n]=t,E.pi[u][n]=o}),n=(e=>{var t,r,n,s,a,i;for(f=g(0,e),M(f,1),a=[],t=i=1,s=e;1<=s?i<=s:i>=s;t=1<=s?++i:--i)f=g(t,e),a.push(function(){var e,s;for(r in s=[],e=E.m[t-1])n=e[r],r=parseInt(r),"bruteforce"!==n.pattern&&s.push(M(f,r+1));return s}());return a}),g=((t,r)=>({pattern:"bruteforce",token:e.slice(t,+r+1||9e9),i:t,j:r})),P=(e=>{var t,r,n,s,a,i,u;for(r in i=[],s=e-1,a=void 0,n=Infinity,u=E.g[s])(t=u[r])<n&&(a=r,n=t);for(;s>=0;)f=E.m[s][a],i.unshift(f),s=f.i-1,a--;return i}),a=I=0,R=c;0<=R?I<R:I>R;a=0<=R?++I:--I){for(k=0,h=(m=_[a]).length;k<h;k++)if((f=m[k]).i>0)for(i in E.m[f.i-1])i=parseInt(i),M(f,i+1);else M(f,1);n(a)}return p=(A=P(c)).length,s=0===e.length?1:E.g[c-1][p],{password:e,guesses:s,guesses_log10:this.log10(s),sequence:A}},estimate_guesses:function(e,t){var r,n;return null!=e.guesses?e.guesses:(n=1,e.token.length<t.length&&(n=1===e.token.length?10:50),r={bruteforce:this.bruteforce_guesses,dictionary:this.dictionary_guesses,spatial:this.spatial_guesses,repeat:this.repeat_guesses,sequence:this.sequence_guesses,regex:this.regex_guesses,date:this.date_guesses}[e.pattern].call(this,e),e.guesses=Math.max(r,n),e.guesses_log10=this.log10(e.guesses),e.guesses)},bruteforce_guesses:function(e){var t,r;return(t=Math.pow(10,e.token.length))===Number.POSITIVE_INFINITY&&(t=Number.MAX_VALUE),r=1===e.token.length?11:51,Math.max(t,r)},repeat_guesses:function(e){return e.base_guesses*e.repeat_count},sequence_guesses:function(e){var t,r;return t="a"===(r=e.token.charAt(0))||"A"===r||"z"===r||"Z"===r||"0"===r||"1"===r||"9"===r?4:r.match(/\d/)?10:26,e.ascending||(t*=2),t*e.token.length},MIN_YEAR_SPACE:20,REFERENCE_YEAR:(new Date).getFullYear(),regex_guesses:function(e){var t,r;if(t={alpha_lower:26,alpha_upper:26,alpha:52,alphanumeric:62,digits:10,symbols:33},e.regex_name in t)return Math.pow(t[e.regex_name],e.token.length);switch(e.regex_name){case"recent_year":return r=Math.abs(parseInt(e.regex_match[0])-this.REFERENCE_YEAR),r=Math.max(r,this.MIN_YEAR_SPACE)}},date_guesses:function(e){var t;return t=365*Math.max(Math.abs(e.year-this.REFERENCE_YEAR),this.MIN_YEAR_SPACE),e.separator&&(t*=4),t},KEYBOARD_AVERAGE_DEGREE:t(e.qwerty),KEYPAD_AVERAGE_DEGREE:t(e.keypad),KEYBOARD_STARTING_POSITIONS:function(){var t,n;for(r in n=[],t=e.qwerty)t[r],n.push(r);return n}().length,KEYPAD_STARTING_POSITIONS:function(){var t,n;for(r in n=[],t=e.keypad)t[r],n.push(r);return n}().length,spatial_guesses:function(e){var t,r,n,s,a,i,u,o,h,f,g,_,c,l,E,p,A;for("qwerty"===(f=e.graph)||"dvorak"===f?(l=this.KEYBOARD_STARTING_POSITIONS,s=this.KEYBOARD_AVERAGE_DEGREE):(l=this.KEYPAD_STARTING_POSITIONS,s=this.KEYPAD_AVERAGE_DEGREE),a=0,t=e.token.length,p=e.turns,i=o=2,g=t;2<=g?o<=g:o>=g;i=2<=g?++o:--o)for(u=h=1,_=Math.min(p,i-1);1<=_?h<=_:h>=_;u=1<=_?++h:--h)a+=this.nCk(i-1,u-1)*l*Math.pow(s,u);if(e.shifted_count)if(r=e.shifted_count,n=e.token.length-e.shifted_count,0===r||0===n)a*=2;else{for(E=0,i=A=1,c=Math.min(r,n);1<=c?A<=c:A>=c;i=1<=c?++A:--A)E+=this.nCk(r+n,i);a*=E}return a},dictionary_guesses:function(e){var t;return e.base_guesses=e.rank,e.uppercase_variations=this.uppercase_variations(e),e.l33t_variations=this.l33t_variations(e),t=e.reversed?2:1,e.base_guesses*e.uppercase_variations*e.l33t_variations*t},START_UPPER:/^[A-Z][^A-Z]+$/,END_UPPER:/^[^A-Z]+[A-Z]$/,ALL_UPPER:/^[^a-z]+$/,ALL_LOWER:/^[^A-Z]+$/,uppercase_variations:function(e){var t,r,n,s,a,i,u,o,h,f,g,_;if((_=e.token).match(this.ALL_LOWER)||_.toLowerCase()===_)return 1;for(i=0,a=(o=[this.START_UPPER,this.END_UPPER,this.ALL_UPPER]).length;i<a;i++)if(f=o[i],_.match(f))return 2;for(r=function(){var e,t,r,s;for(s=[],t=0,e=(r=_.split("")).length;t<e;t++)(n=r[t]).match(/[A-Z]/)&&s.push(n);return s}().length,t=function(){var e,t,r,s;for(s=[],t=0,e=(r=_.split("")).length;t<e;t++)(n=r[t]).match(/[a-z]/)&&s.push(n);return s}().length,g=0,s=u=1,h=Math.min(r,t);1<=h?u<=h:u>=h;s=1<=h?++u:--u)g+=this.nCk(r+t,s);return g},l33t_variations:function(e){var t,r,n,s,a,i,u,o,h,f,g,_;if(!e.l33t)return 1;for(f in _=1,o=e.sub)if(g=o[f],s=e.token.toLowerCase().split(""),t=function(){var e,t,r;for(r=[],t=0,e=s.length;t<e;t++)(n=s[t])===f&&r.push(n);return r}().length,r=function(){var e,t,r;for(r=[],t=0,e=s.length;t<e;t++)(n=s[t])===g&&r.push(n);return r}().length,0===t||0===r)_*=2;else{for(u=0,a=i=1,h=Math.min(r,t);1<=h?i<=h:i>=h;a=1<=h?++i:--i)u+=this.nCk(r+t,a);_*=u}return _}}});
//# sourceMappingURL=sourcemaps/scoring.js.map
